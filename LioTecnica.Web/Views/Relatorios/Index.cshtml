@{
    ViewData["Title"] = "Portal RH • Liotécnica — Relatórios";
    ViewData["SidebarSubtitle"] = "Relatórios";
}



<!-- MOBILE SIDEBAR OFFCANVAS -->

      @section Topbar {
<div class="d-flex align-items-center gap-2">
            <button class="btn btn-ghost d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar">
              <i class="bi bi-list"></i>
            </button>
            <div class="d-none d-md-block">
              <div class="fw-bold" style="color:var(--lt-primary); line-height:1.05;">Liotécnica • Portal RH</div>
              <small class="text-muted">Tela: Relatórios</small>
            </div>
          </div>

          <div class="d-flex align-items-center gap-2">
            <button class="btn btn-ghost" type="button" id="btnSeedReset" title="Restaurar demo">
              <i class="bi bi-arrow-counterclockwise"></i><span class="d-none d-sm-inline ms-1">Reset demo</span>
            </button>

            <button class="btn btn-ghost" type="button" id="btnExport" title="Exportar relatório atual (CSV)">
              <i class="bi bi-filetype-csv"></i><span class="d-none d-sm-inline ms-1">Exportar CSV</span>
            </button>

            <button class="btn btn-brand" type="button" id="btnRun">
              <i class="bi bi-play-circle"></i><span class="d-none d-sm-inline ms-1">Gerar</span>
            </button>

            <div class="dropdown">
              <button class="btn btn-ghost dropdown-toggle" data-bs-toggle="dropdown">
                <i class="bi bi-person-circle me-1"></i><span class="d-none d-sm-inline">RH</span>
              </button>
              <ul class="dropdown-menu dropdown-menu-end">
                <li><a class="dropdown-item" href="#"><i class="bi bi-person-gear me-2"></i>Meu perfil</a></li>
                <li><a class="dropdown-item" href="#"><i class="bi bi-bell me-2"></i>Notificações</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item text-danger" href="#"><i class="bi bi-box-arrow-right me-2"></i>Sair</a></li>
              </ul>
            </div>
          </div>
}

      <!-- CONTENT -->
      <section class="content">
        <div class="page-title">
          <div>
            <h4>Relatórios</h4>
            <div class="subtitle">Gere relatórios operacionais e gerenciais (mocado). No sistema real: filtros → query Postgres → exportação.</div>
          </div>
          <div class="d-flex align-items-center gap-2 flex-wrap justify-content-end">
            <span class="badge-soft"><i class="bi bi-clock me-1"></i><span id="nowLabel">—</span></span>
            <span class="badge-soft"><i class="bi bi-hdd me-1"></i>localStorage</span>
          </div>
        </div>

        <!-- KPI row -->
        <div class="row g-2 mb-3">
          <div class="col-6 col-lg-3">
            <div class="card-soft p-3">
              <div class="mini-title mb-1">Vagas</div>
              <div class="d-flex align-items-end justify-content-between">
                <div class="fw-bold" style="font-size:1.6rem;color:var(--lt-primary);" id="kpiVagas">0</div>
                <span class="pill"><i class="bi bi-briefcase"></i>ativas</span>
              </div>
              <div class="text-muted small mt-1">Total no cadastro (demo).</div>
            </div>
          </div>
          <div class="col-6 col-lg-3">
            <div class="card-soft p-3">
              <div class="mini-title mb-1">Candidatos</div>
              <div class="d-flex align-items-end justify-content-between">
                <div class="fw-bold" style="font-size:1.6rem;color:var(--lt-primary);" id="kpiCands">0</div>
                <span class="pill"><i class="bi bi-people"></i>base</span>
              </div>
              <div class="text-muted small mt-1">Recebidos/triados (demo).</div>
            </div>
          </div>
          <div class="col-6 col-lg-3">
            <div class="card-soft p-3">
              <div class="mini-title mb-1">Entrada</div>
              <div class="d-flex align-items-end justify-content-between">
                <div class="fw-bold" style="font-size:1.6rem;color:var(--lt-primary);" id="kpiInbox">0</div>
                <span class="pill"><i class="bi bi-inbox"></i>itens</span>
              </div>
              <div class="text-muted small mt-1">Fila (novo/processando).</div>
            </div>
          </div>
          <div class="col-6 col-lg-3">
            <div class="card-soft p-3">
              <div class="mini-title mb-1">Conversão</div>
              <div class="d-flex align-items-end justify-content-between">
                <div class="fw-bold" style="font-size:1.6rem;color:var(--lt-primary);" id="kpiConv">0%</div>
                <span class="pill"><i class="bi bi-arrow-right-circle"></i>triagem</span>
              </div>
              <div class="text-muted small mt-1">Processado → candidato.</div>
            </div>
          </div>
        </div>

        <div class="grid2">
          <!-- LEFT: catálogo de relatórios + filtros -->
          <div>
            <div class="card-soft p-3 mb-3">
              <div class="d-flex align-items-start justify-content-between gap-2">
                <div>
                  <div class="fw-bold">Catálogo de relatórios</div>
                  <div class="text-muted small">Selecione um relatório e configure filtros.</div>
                </div>
                <span class="pill"><i class="bi bi-lightning-charge"></i>mocado</span>
              </div>

              <hr class="my-3 divider">

              <div class="d-grid gap-2" id="reportList"></div>
            </div>

            <div class="card-soft p-3">
              <div class="fw-bold">Filtros</div>
              <div class="text-muted small">Os filtros alteram a tabela/“gráfico” do relatório selecionado.</div>

              <div class="row g-2 mt-2">
                <div class="col-12">
                  <label class="form-label small">Período</label>
                  <select class="form-select" id="fPeriod">
                    <option value="7d">Últimos 7 dias</option>
                    <option value="30d" selected>Últimos 30 dias</option>
                    <option value="90d">Últimos 90 dias</option>
                    <option value="ytd">Ano atual (YTD)</option>
                  </select>
                </div>

                <div class="col-12">
                  <label class="form-label small">Vaga</label>
                  <select class="form-select" id="fVaga">
                    <option value="all" selected>Todas</option>
                  </select>
                </div>

                <div class="col-12">
                  <label class="form-label small">Origem</label>
                  <select class="form-select" id="fOrigem">
                    <option value="all" selected>Todas</option>
                    <option value="email">Email</option>
                    <option value="pasta">Pasta</option>
                    <option value="upload">Upload</option>
                  </select>
                </div>

                <div class="col-12">
                  <label class="form-label small">Status</label>
                  <select class="form-select" id="fStatus">
                    <option value="all" selected>Todos</option>
                    <option value="novo">Novo</option>
                    <option value="processando">Processando</option>
                    <option value="processado">Processado</option>
                    <option value="falha">Falha</option>
                    <option value="descartado">Descartado</option>
                  </select>
                </div>

                <div class="col-12">
                  <label class="form-label small">Buscar</label>
                  <div class="input-group">
                    <span class="input-group-text" style="background:rgba(255,255,255,.65)"><i class="bi bi-search"></i></span>
                    <input class="form-control" id="fSearch" placeholder="Nome, email, assunto, arquivo...">
                  </div>
                </div>
              </div>

              <div class="d-flex flex-wrap gap-2 mt-3">
                <button class="btn btn-brand btn-sm" id="btnApply"><i class="bi bi-filter-circle me-1"></i>Aplicar</button>
                <button class="btn btn-ghost btn-sm" id="btnClear"><i class="bi bi-x-circle me-1"></i>Limpar</button>
              </div>

              <div class="text-muted small mt-3">
                <i class="bi bi-info-circle me-1"></i>
                No produto real: filtros viram parâmetros de query e agregações no Postgres.
              </div>
            </div>
          </div>

          <!-- RIGHT: relatório selecionado -->
          <div>
            <div class="card-soft p-3 mb-3">
              <div class="d-flex flex-wrap align-items-start justify-content-between gap-2">
                <div>
                  <div class="fw-bold" id="reportTitle">—</div>
                  <div class="text-muted small" id="reportDesc">Selecione um relatório no catálogo.</div>
                </div>
                <div class="d-flex flex-wrap gap-2 justify-content-end">
                  <span class="tag" id="tagScope"><i class="bi bi-sliders"></i>escopo</span>
                  <span class="tag ok" id="tagFresh"><i class="bi bi-clock-history"></i>atual</span>
                </div>
              </div>

              <hr class="my-3 divider">

              <div class="chart-wrap mb-3">
                <!-- gráfico simples em canvas (mocado) -->
                <canvas id="chart" style="width:100%; height:100%;"></canvas>
              </div>

              <div class="d-flex align-items-center justify-content-between gap-2 flex-wrap">
                <div class="mini-title">Resultados</div>
                <div class="d-flex gap-2 flex-wrap">
                  <span class="pill"><i class="bi bi-table"></i><span id="rowCount">0</span> linhas</span>
                  <span class="pill"><i class="bi bi-filetype-csv"></i>exportável</span>
                </div>
              </div>

              <div class="table-responsive mt-2">
                <table class="table table-sm align-middle mb-0" id="resultTable">
                  <thead>
                    <tr id="theadRow"></tr>
                  </thead>
                  <tbody id="tbodyRows"></tbody>
                </table>
              </div>

              <div class="text-muted small mt-3" id="resultHint"></div>
            </div>

            <div class="card-soft p-3">
              <div class="fw-bold">Agendamento (MVP+)</div>
              <div class="text-muted small">Exemplo visual de como seria agendar envio automático por e-mail (não funcional).</div>

              <div class="row g-2 mt-2">
                <div class="col-12 col-md-6">
                  <label class="form-label small">Destinatários</label>
                  <input class="form-control" placeholder="ex.: rh@@empresa.com; gestor@@empresa.com">
                </div>
                <div class="col-6 col-md-3">
                  <label class="form-label small">Frequência</label>
                  <select class="form-select">
                    <option>Diário</option>
                    <option selected>Semanal</option>
                    <option>Mensal</option>
                  </select>
                </div>
                <div class="col-6 col-md-3">
                  <label class="form-label small">Dia/Hora</label>
                  <input class="form-control" placeholder="Seg 09:00">
                </div>
              </div>

              <div class="d-flex flex-wrap gap-2 mt-3">
                <button class="btn btn-ghost btn-sm"><i class="bi bi-calendar2-check me-1"></i>Salvar agendamento</button>
                <button class="btn btn-ghost btn-sm"><i class="bi bi-send me-1"></i>Enviar agora (teste)</button>
              </div>
            </div>
          </div>
        </div>

        <div style="height:14px;"></div>
      </section>

      @section Footer {
<div class="d-flex flex-wrap align-items-center justify-content-between gap-2">
          <div>© <span id="year"></span> Liotécnica • Portal RH (MVP)</div>
          <div class="d-flex align-items-center gap-3">
            <span><i class="bi bi-graph-up me-1"></i>Relatórios</span>
            <span><i class="bi bi-shield-check me-1"></i>LGPD</span>
            <span class="mono muted" id="buildId">build: demo</span>
          </div>
        </div>
}

    

  <!-- Bootstrap JS (CDN) -->

@section Scripts {
<script src="~/js/views/relatorios.js" asp-append-version="true"></script>
}
